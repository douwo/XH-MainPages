<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8" />
		<title>mainPage</title>
		<link rel="stylesheet" type="text/css" href="css/layui.css" />
		<link rel="stylesheet" type="text/css" href="css/font-awesome.min.css" />
		<link rel="stylesheet" type="text/css" href="sass/index.css" />
	</head>

	<body class="layui-layout-body">
		<div class="layui-layout layui-layout-admin">
			<div class="layui-header">
				<div class="layui-logo">后台管理系统<sup>V0.0.1</sup></div>
				<!-- 头部区域（可配合layui已有的水平导航） -->
				<ul class="layui-nav layui-layout-left">
				</ul>
				<ul class="layui-nav layui-layout-right">
					<li class="layui-nav-item">
						<a href="javascript:;">
							<img src="img/users-head.jpg" class="layui-nav-img">
							<span>Admin</span>
						</a>
						<dl class="layui-nav-child">
							<dd>
								<a href="">基本资料</a>
							</dd>
							<dd>
								<a href="">安全设置</a>
							</dd>
						</dl>
					</li>
					<li class="layui-nav-item">
						<a href="">安全退出&nbsp;<i class="fa fa-power-off"></i></a>
					</li>
				</ul>
			</div>

			<div class="layui-side layui-bg-black">
				<div class="layui-side-scroll">
					<!-- 左侧导航区域（可配合layui已有的垂直导航） -->
					<ul id="left-nav" class="layui-nav layui-nav-tree" lay-filter="leftNav">
						<li class="layui-nav-item layui-nav-itemed">
							<a class="" href="javascript:;">所有商品</a>
							<dl class="layui-nav-child">
								<dd>
									<a href="javascript:;" onclick="addTab('demo','111','网站设置')">网站设置</a>
								</dd>
								<dd>
									<a href="javascript:;" onclick="addTab('demo','222','商品管理')">商品管理</a>
								</dd>
								<dd>
									<a href="javascript:;" onclick="addTab('demo','333','订单管理')">订单管理</a>
								</dd>
							</dl>
						</li>
					</ul>
				</div>
			</div>

			<div class="layui-body">
				<div style="padding: 0px;">
					<div class="layui-tab layui-tab-card" lay-filter="demo" lay-allowClose="true">
						<ul class="layui-tab-title">
							<li class="layui-this" lay-id="111" ondblclick="delTab('demo','111')">网站设置</li>
						</ul>
						<div class="layui-tab-content">
							<div class="layui-tab-item layui-show">内容1</div>
						</div>
					</div>
				</div>
			</div>
			<div class="layui-footer" style="text-align: center;height: ;">
				<!-- 底部固定区域 -->
				© xh 2018
			</div>
		</div>
	</body>
	<script src="js/jquery-3.2.1.min.js" type="text/javascript" charset="utf-8"></script>
	<script src="js/layui.all.js" type="text/javascript" charset="utf-8"></script>
	<script type="text/javascript">
		$(function() {
			var _text = '';
			$.get("left-nav.json", function(result) {
				$.each(result.mainTitle, function(index, obj) {
					_text = _text + '<li class="layui-nav-item"><a class="" href="javascript:;">' +
						obj.name + '</a><dl class="layui-nav-child">';
					$.each(obj.second, function(index, obj2) {
						_text = _text + '<dd><a href="javascript:;" onclick="addTab(\'demo\',\'' + obj2.id + '\',\'' + obj2.title + '\')">' + obj2.title + '</a></dd>'
					});
					_text = _text + '</dl></li>';
				});
				$('#left-nav').html(_text);
				var element = layui.element;
				element.render();
			});
			layui.use('element', function() {
				var element = layui.element;
				element.on('tab(demo)', function(data) {
					var _title = $(this).text();
					var _titleLength = _title.length;
					_title = _title.substr(0, _titleLength - 1);
					var _dd = $('#left-nav dd');
					_dd.each(function() {
						if(_title == $(this).text()) {
							_dd.removeClass('layui-this');
							$(this).addClass('layui-this');
							return;
						}
					})
				});
				element.on('tabDelete(demo)', function(data) {
					var tab_content = $.trim($(".layui-tab-title").text())
					if(tab_content == ''){
						$('#left-nav dd').removeClass('layui-this');
					}
				});
			});
		})

		function addTab(filter, id, title) {
			var flag = 0;
			var element = layui.element;
			$('.layui-tab-title>li').each(function() {
				var _title = $.trim($(this).text());
				var _titleLength = _title.length;
				_title = _title.substr(0, _titleLength - 1);
				if(_title == title) {
					element.tabChange(filter, id);
					flag = 1;
					return false;
				}
			});
			if(flag == 1) {
				return;
			} else {
				element.tabAdd('demo', {
					title: title,
					content: '<iframe src="StuPage.html" width="100%" height="100%"></iframe>', //支持传入html
					id: id
				});
				element.tabChange(filter, id);
			}
		}

	</script>

</html>